<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="stylesheet" href="./style.css">
    <link rel="icon" href="https://colegiosatelite.com.br/wp-content/uploads/2021/05/icon-1.png" sizes="192x192">
    <link rel="icon" href="https://colegiosatelite.com.br/wp-content/uploads/2021/05/icon-1.png" sizes="32x32">
    <link rel="apple-touch-icon" href="https://colegiosatelite.com.br/wp-content/uploads/2021/05/icon-1.png">

    <title>Agendamento</title>
</head>
<body>

    <div id="overlay" hidden>
        <div class="overlay_popup">
            <div class="loading_text" id="loading">
                Realizando agendamento...
            </div>
            <div class="success_text" id="success" hidden>
                <span>Agendamento realizado com sucesso.</span>
                <button class="loading_return" id="loading_return" onclick="closeLoading()">Voltar</button>
            </div>
            <div class="error_text" id="error" hidden>
                <span>Erro ao realizar o agendamento!</span>
                <span id="error_reason"></span>
                <button class="loading_return" id="loading_return" onclick="closeLoading()">Voltar</button>
            </div>
        </div>
    </div>

    <header>
        <div class="title">
            <img src="./logo.png" alt="logo">
            <h1>Agendamento de Chromes</h1>
        </div>
        <nav>
            <a href="https://colegiosatelite.com.br/agendamento">Início</a>
            <a href="https://colegiosatelite.com.br/agendamento/me">Meus Agendamentos</a>
            <a href="https://colegiosatelite.com.br/agendamento/painel">Administrador</a>
        </nav>
    </header>

    <main>
        <section class="authpanel" id="auth">
            <button id="authorize_button" onclick="authorizeAgendamentos()" class="auth">Login</button>
            <button id="signout_button" onclick="handleSignoutClick(false)" class="auth" hidden>Logout</button>
        </section>
    
        <section id="content" hidden>
            <form autocomplete="off" method="POST" id="agendamento" action="https://script.google.com/macros/s/AKfycbw2slmbsIiKp7AKSjxlIhbA_A_dq-6_rs-DyXS2Ej48Fr1_g7SJjQyvoyw-nIXMfeIJeg/exec">
                <div class="date">
                    <div class="dateinput">
                        <label for="emprestimohora" class="inputlabel">Empréstimo</label> <input type="datetime-local" name="emprestimohora" id="emprestimohora" required>
                    </div>
                    <div class="dateinput">
                        <label for="devolucaohora" class="inputlabel">Devolução</label> <input type="datetime-local" name="devolucaohora" id="devolucaohora" required>
                    </div>
                </div>
                <select name="turma" id="turma" required>
                    <option value="">Selecione uma Turma</option>
                    <option value="0">Maternal</option>
                    <option value="1">Jardim</option>
                    <option value="2">Pré</option>
                    <option value="3">1º Ano</option>
                    <option value="4">2º Ano</option>
                    <option value="5">3º Ano</option>
                    <option value="6">4º Ano</option>
                    <option value="7">5º Ano</option>
                    <option value="8">6º Ano</option>
                    <option value="9">7º Ano</option>
                    <option value="10">8º Ano</option>
                    <option value="11">9º Ano</option>
                    <option value="12">1º Médio</option>
                    <option value="13">2º Médio</option>
                    <option value="14">3º Médio</option>
                    <option value="15">Bilíngue</option>
                    <option value="16">Uso Próprio</option>
                </select>
                <div id="chrome"></div>
                <input type="text" name="obs" id="obs" placeholder="Observação">
                <button type="submit" class="submit">Agendar</button>
            </form>
        </section>
    </main>

    <footer>
        <p>Site desenvolvido pela equipe de TI</p>
        <p>Email para suporte: <a target="_blank" href="https://mail.google.com/a/colegiosatelite.com.br/mail/?extsrc=mailto&url=mailto%3Agustavo.martinez%40colegiosatelite.com.br%3Fsubject%3DSuporte%20para%20o%20website%20de%20Agendamentos">gustavo.martinez@colegiosatelite.com.br</a></p>
    </footer>

    <script type="text/javascript" src="./auth.js"></script>
    <script async defer src="https://apis.google.com/js/api.js" onload="gapiLoaded()"></script>
    <script async defer src="https://accounts.google.com/gsi/client" onload="gisAgendamentoLoaded()"></script>
    <script src="./script.js" type="text/javascript" defer></script>
    <script src="./getSheetData.js" type="text/javascript" defer></script>
</body>
</html>